# Автотесты проверки авторизации
## Настройка окружения
```
cd <your_location>/maximum_web
virtaulenv .venv
source .venv/bin/activate
pip install -r requirements.txt
```
## Конфигурирование тестов
Конфигурирование автотестов осуществляется в файле settings.py. Некоторые из параметров можно задать через переменные окружения.
Параметры, которые можно указать через переменные окружения:
- **url** - базовый урл сайта
- **implicit_wait** - таймаут ожидание элемента на странице, в секундах. По умолчанию 10
- **browser_name** - браузер в котором будут запущены тесты. Доступные значения chrome (по умолчанию), edge и firefox
- **local_run** - запускать тесты локально (по умолчанию) или в selenium grid
- **headless** - режим запуска браузера (только для firefox или chrome) без графического интерфейса (по умолчанию False)

Остальные параметры:
- username / password - данные о пользователе
- browser_version - используется, если нужно явно указать версию браузера
- local_driver_cache_valid_range - время жизни кэша драйвера, загруженного webdriver-manager, в днях
- grid_url - адрес selenium hub сервиса

## Загрузка веб-драйвер
Непосредственно сам файл ведрайвера отсутствует в проекте и будет загружен автоматически при первом запуске, 
используя библиотеку webdriver-manager https://pypi.org/project/webdriver-manager/
Поэтому, в зависимости от скорости интернета, возможно задержка перед первым открытием браузера, 
пока вебдрайвер не будет скачан на файловую систему в папку .wdm.
Чтобы не скачивать драйвер каждый раз при запуске, в настройках settings.py используется опция 
local_driver_cache_valid_range.

## Запуск тестов и отчёты
Отчёты представлены в 3 видах: стандартный вывод pytest, html (плагин pytest-html), allure (плагин allure-pytest)
### text
Текстовый результат (без заголовка и с итоговым выводом по тестам) можно перенаправить в файл: 
`pytest --no-header -rA tests/test_reports.py > reports/text/report.text`
### allure
Для получения отчёта в аннотации allure, тесты запускаются следующим образом:
`pytest --alluredir=./reports/allure/`
Для генерирования и просмотра отчёта в системе должен быть установлен allure cli 

https://docs.qameta.io/allure/#_installing_a_commandline 

Для просмотра готового отчёта, необходимо перейти в reports/allure/ распаковать файл allure.zip и запустить команду
`allure serve ./allure-report/`
### html
Для получения отчёта в виде одного простого html файла, тесты необходимо запустить с параметрами:
`pytest --html=reports/html/report.html --self-contained-html`
## Ограничения
Версия python 3.6 и выше
